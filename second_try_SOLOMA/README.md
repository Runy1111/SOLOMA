# ü§ñ Telegram Moderation Bot with Agent System

–ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π —Ç–µ–ª–µ–≥—Ä–∞–º‚Äë–±–æ—Ç —Å –∞–≥–µ–Ω—Ç–Ω–æ–π —Å–∏—Å—Ç–µ–º–æ–π –¥–ª—è –º–æ–¥–µ—Ä–∞—Ü–∏–∏ —á–∞—Ç–æ–≤, –∏—Å–ø–æ–ª—å–∑—É—é—â–∏–π –ª–æ–∫–∞–ª—å–Ω—ã–µ —ç–≤—Ä–∏—Å—Ç–∏–∫–∏ –∏ LLM (GigaChat).

## –ö—Ä–∞—Ç–∫–æ
- –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –±–æ—Ç, —Ä–∞–∑–¥–µ–ª—ë–Ω–Ω—ã–π –Ω–∞ –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã–µ –∞–≥–µ–Ω—Ç—ã: –º–æ–¥–µ—Ä–∞—Ç–æ—Ä, —Å–ø–µ–ª–ª—á–µ–∫–µ—Ä, –∫–æ—Ä—Ä–µ–∫—Ç–æ—Ä –∏ —Å–ø–∞–º‚Äë–¥–µ—Ç–µ–∫—Ç–æ—Ä.
- –í—Å–µ –∞–≥–µ–Ω—Ç—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç –æ–±—â–∏–π `GigachatClient` –¥–ª—è –≤—ã–∑–æ–≤–æ–≤ LLM; –ª–æ–∫–∞–ª—å–Ω—ã–µ —ç–≤—Ä–∏—Å—Ç–∏–∫–∏ –º–∏–Ω–∏–º–∏–∑–∏—Ä—É—é—Ç –ª–∏—à–Ω–∏–µ –≤—ã–∑–æ–≤—ã.
- –¢–µ—Å—Ç–æ–≤—ã–π —Ä–∞–Ω–Ω–µ—Ä –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç `mock` –∏ `live` —Ä–µ–∂–∏–º—ã –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –º–µ—Ç—Ä–∏–∫–∏ –≤ `tests/output/`.

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞ (–∫–ª—é—á–µ–≤—ã–µ —Ñ–∞–π–ª—ã)
- `main.py` ‚Äî —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞, –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è –ª–æ–≥–∏–∫–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π.
- `gigachat_client.py` ‚Äî –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –∫–ª–∏–µ–Ω—Ç –¥–ª—è GigaChat (authenticate, generate, close).
- `agents/` ‚Äî –∞–≥–µ–Ω—Ç—ã:
  - `agent_moderator.py` ‚Äî –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π (CLEAN / CATEGORY_A / CATEGORY_B / CATEGORY_C).
  - `agent_spellchecker.py` ‚Äî –æ—Ä—Ñ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ (NO_ERRORS / CORRECTED).
  - `agent_corrector.py` ‚Äî —Å—Ç–∏–ª—å/—Å–º—è–≥—á–µ–Ω–∏–µ/–∫–æ—Ä—Ä–µ–∫—Ü–∏—è –Ω–∞—Ä—É—à–µ–Ω–∏–π.
  - `agent_spam_detector.py` ‚Äî –¥–µ—Ç–µ–∫—Ç–æ—Ä —Å–ø–∞–º–∞ (SequenceMatcher).
- `storage/storage.py` ‚Äî JSON‚Äë—Ö—Ä–∞–Ω–∏–ª–∏—â–µ –¥–ª—è –Ω–∞—Ä—É—à–µ–Ω–∏–π/–±–∞–Ω–æ–≤/–∏—Å—Ç–æ—Ä–∏–∏.
- `tests/run_test_pipeline.py` ‚Äî —Ä–∞–Ω–Ω–µ—Ä –¥–ª—è –ø–∞–∫–µ—Ç–Ω—ã—Ö –ø—Ä–æ–≥–æ–Ω–æ–≤ (mock/live).

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞
–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è: Python 3.8+.

1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:

```bash
pip install -r requirements.txt
```

2. –°–æ–∑–¥–∞–π—Ç–µ `.env` –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞ —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏:

```
TELEGRAM_TOKEN=your_telegram_token
GIGACHAT_CLIENT_ID=your_gigachat_client_id
GIGACHAT_AUTH_KEY=your_gigachat_auth_key
```

3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç–∞ (–∏–ª–∏ —Ç–µ—Å—Ç–æ–≤—ã–π —Ä–µ–∂–∏–º):

```bash
python3 main.py
# –∏–ª–∏
python3 test_mode.py
```

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- Mock-–ø—Ä–æ–≥–æ–Ω—ã (deterministic):

```bash
PYTHONPATH=. python3 tests/run_test_pipeline.py --mode mock
```

- Live-–ø—Ä–æ–≥–æ–Ω—ã (—Ä–µ–∞–ª—å–Ω—ã–π LLM):

```bash
PYTHONPATH=. python3 tests/run_test_pipeline.py --mode live
```

–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ `tests/output/metrics_*.json`.

## –ö–ª—é—á–µ–≤—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤
- –ú–æ–¥–µ—Ä–∞—Ç–æ—Ä –∫–æ–º–±–∏–Ω–∏—Ä—É–µ—Ç –ª–æ–∫–∞–ª—å–Ω—ã–µ —ç–≤—Ä–∏—Å—Ç–∏–∫–∏ (–ø–æ–∏—Å–∫ –§–ò–û, –ø—Å–µ–≤–¥–æ–Ω–∏–º–æ–≤, —Ç—Ä–∞–Ω—Å–ª–∏—Ç + fuzzy) –∏ —Ç–∞—Ä–≥–µ—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ LLM‚Äë–∑–∞–ø—Ä–æ—Å—ã; –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –ª–æ–∫–∞–ª—å–Ω—ã—Ö –¥–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤ LLM‚Äë–æ—Ç–≤–µ—Ç—ã –Ω–∞ CATEGORY_C –ø–æ–Ω–∏–∂–∞—é—Ç—Å—è –¥–æ CLEAN.
- –°–ø–µ–ª–ª—á–µ–∫–µ—Ä –æ–∂–∏–¥–∞–µ—Ç —Å—Ç—Ä–æ–≥–æ—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã –æ—Ç LLM (NO_ERRORS / CORRECTED ...); –¥–ª—è —Ç–æ—á–Ω–æ–≥–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞—Ç—å –≤—ã–≤–æ–¥ –ø–µ—Ä–µ–¥ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ–º.
- –°–ø–∞–º‚Äë–¥–µ—Ç–µ–∫—Ç–æ—Ä —Ö—Ä–∞–Ω–∏—Ç –ø–æ—Å–ª–µ–¥–Ω–∏–µ N —Å–æ–æ–±—â–µ–Ω–∏–π –≤ –ø–∞–º—è—Ç–∏ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 10) –∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç SequenceMatcher –¥–ª—è –æ—Ü–µ–Ω–∫–∏ —Å—Ö–æ–¥—Å—Ç–≤–∞.


---
¬© –ü—Ä–æ–µ–∫—Ç ‚Äî internal
